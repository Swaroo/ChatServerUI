(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{30:function(e,t,n){e.exports=n.p+"static/media/logo.25bf045c.svg"},34:function(e,t,n){e.exports=n(63)},39:function(e,t,n){},40:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),o=n(15),r=n.n(o),l=(n(39),n(31)),c=n(7);n(30),n(40);var u=n(10),i=n(11),g=n(13),m=n(12),h=n(14),d=n(16),p=n.n(d),f=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(g.a)(this,Object(m.a)(t).call(this,e))).copyState=function(e){return Object.assign({},e)},n.onNameChange=function(e){n.setState({username:e.target.value})},n.onPasswordChange=function(e){n.setState({password:e.target.value})},n.onUrlChange=function(e){n.setState({url:e.target.value})},n.onSubmit=function(e){e.preventDefault(),console.log("Login form submitted\n"),console.log("username: "+n.state.username),console.log("password: "+n.state.password),sessionStorage.url=n.state.url,p.a.post(n.state.url+"/login",null,{params:{username:n.state.username,password:n.state.password},headers:{"Access-Control-Allow-Origin":"*"}}).then((function(e){console.log(e);var t=e.data.token,a=n.copyState(n.state.tokens);a[n.state.username]=t,n.setState({tokens:a}),console.log(n.state.tokens),n.props.history.push({pathname:"/board",state:{token:t}})}),(function(e){console.log(e),403===e.response.status&&(console.log("403"),alert("Wrong password"))}))},n.state={username:"",password:"",url:"",tokens:{}},n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("form",{onSubmit:this.onSubmit},s.a.createElement("h1",null,"Login"),s.a.createElement("label",null," ",s.a.createElement("b",null,"Beackend-URL")," "),s.a.createElement("input",{type:"text",value:this.state.url,onChange:this.onUrlChange,required:!0}),s.a.createElement("br",null),s.a.createElement("label",null," ",s.a.createElement("b",null,"Username")," "),s.a.createElement("input",{type:"text",value:this.state.username,onChange:this.onNameChange,required:!0}),s.a.createElement("br",null),s.a.createElement("label",null," ",s.a.createElement("b",null,"Password")," "),s.a.createElement("input",{type:"password",value:this.state.password,onChange:this.onPasswordChange,required:!0}),s.a.createElement("br",null),s.a.createElement("button",{type:"submit",className:"btn"},"Login")))}}]),t}(s.a.Component),v=n(6);function b(e){var t=new Date(1e3*e);return t.toLocaleDateString("en-US")+" "+t.toLocaleTimeString("en-US")}var E=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(g.a)(this,Object(m.a)(t).call(this,e))).onMessageChange=function(e){console.log("a"),n.setState({out_message:e.target.value}),"Enter"===e.target.value&&console.log("You typed enter!\n")},n.onKeyDown=function(e){if(13===e.keyCode){var t=n.state.out_message;console.log("enter pressed!"),console.log("sending this message to server: "+t),console.log("with this token: "+n.state.token),n.setState({out_message:""}),p.a.post(sessionStorage.url+"/message",null,{params:{message:t},headers:{"Access-Control-Allow-Origin":"*",Authorization:"Bearer ".concat(n.state.token)}}).then((function(e){console.log(e)}),(function(e){console.log(e),403===e.response.status&&console.log("403: Token not valid")}))}},n.onTextChange=function(e){n.setState({out_message:e.target.value})},n.state={board_data:"This is default data on board",messages:["Messages"],users:["Online"],columns:"this is a column",token:""},n}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){var e=this.props.location.state;if(void 0===e)return console.log("old_state is undefined"),void this.props.history.push({pathname:"/",state:{}});console.log("old state: "),console.log(e),console.log("old token: "+e.token),this.setState({token:e.token});var t=new EventSource(sessionStorage.url+"/stream/"+e.token),n=this;t.onerror=function(e){console.log("Connection error",e),t.close()},t.addEventListener("Part",(function(e){console.log("Part");var t=JSON.parse(e.data);console.log(t);var a=t.user;console.log(a),n.setState({users:n.state.users.filter((function(e){return e!==a}))});var s=b(t.created)+" : "+t.user+" got bored and left the chat.";n.setState({messages:[].concat(Object(v.a)(n.state.messages),[s])}),console.log("my users:"),console.log(n.state.users)}),!1),t.addEventListener("Users",(function(e){console.log("Users");var t=JSON.parse(e.data).users;console.log(t),n.setState({users:["Online"]});for(var a=0;a<t.length;a++)n.setState({users:[].concat(Object(v.a)(n.state.users),[t[a]])})}),!1),t.addEventListener("Join",(function(e){console.log("Join"),console.log(e.data);var t=JSON.parse(e.data),a=b(t.created)+" : Make some noise for "+t.user+".";n.setState({messages:[].concat(Object(v.a)(n.state.messages),[a])}),!1===n.state.users.includes(t.user)&&n.setState({users:[].concat(Object(v.a)(n.state.users),[t.user])})}),!1),t.addEventListener("HeartBeat",(function(e){console.log(e.data)}),!1),t.addEventListener("Disconnect",(function(e){console.log("Stream disconnected",e),t.close(),n.props.history.push({pathname:"/",state:{}})}),!1),t.addEventListener("Message",(function(e){console.log("Message"),console.log(e.data);for(var t=JSON.parse(e.data),a=b(t.created)+" : "+t.user+" SAYS -> "+t.message,s=Object(v.a)(n.state.messages);s.length>40;)s.shift();n.setState({messages:[].concat(Object(v.a)(s),[a])})}),!1),t.addEventListener("ServerStatus",(function(e){console.log("Message"),console.log(e.data);for(var t=JSON.parse(e.data),a=b(t.created)+" STATUS: "+t.status+". Do you know even see my messages, huh?",s=Object(v.a)(n.state.messages);s.length>40;)s.shift();n.setState({messages:[].concat(Object(v.a)(s),[a])})}),!1)}},{key:"render",value:function(){return s.a.createElement("section",{style:{display:"flex",flexDirection:"column",height:"90vh",overflow:"hidden"}},s.a.createElement("h1",{align:"center",style:{color:"green"}}," CS 291 Class"),s.a.createElement("div",{style:{display:"flex",flex:"1",margin:"0.5em 0.5em 0 0.5em",minHeight:"0"}},s.a.createElement(S,{style:{height:"100%",width:"10em",overflow:"scroll",margin:"0 0.5em 0.5em 0.5em",minHeight:"2em"},messages:this.state.messages}),s.a.createElement(S,{style:{height:"100%",width:"20%",overflow:"scroll",marginBottom:"0.5em"},messages:this.state.users})),s.a.createElement("input",{style:{margin:"80vh 0vh",height:"20vh",width:"100%"},type:"text",value:this.state.out_message,onChange:this.onMessageChange,onKeyDown:this.onKeyDown,required:!0}))}}]),t}(s.a.Component),S=function(e){function t(){return Object(u.a)(this,t),Object(g.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement("ul",null,this.props.messages.map((function(e){return s.a.createElement("ul",null,s.a.createElement("div",null,e))})))}}]),t}(s.a.Component),O=E,y=function(){return s.a.createElement("h1",null,"Not found")},w=s.a.createElement(l.a,null,s.a.createElement("div",null,s.a.createElement(c.c,null,s.a.createElement(c.a,{exact:!0,path:"/",component:f}),s.a.createElement(c.a,{exact:!0,path:"/board",component:O}),s.a.createElement(c.a,{component:y}))));r.a.render(w,document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.d133e183.chunk.js.map